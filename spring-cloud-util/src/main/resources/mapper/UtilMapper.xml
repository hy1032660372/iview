<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hy.spring.cloud.util.mapper.UtilMapper">

    <insert id="saveFileList">
        INSERT INTO file_attachment
        (
        id,
        fileName,
        pathUrl,
        fileType,
        status
        )
        VALUES
        <foreach item="el" collection="attachmentList" separator=",">
            (
            #{el.id},
            #{el.fileName},
            #{el.pathUrl},
            #{el.fileType},
            #{el.status}
            )
        </foreach>
    </insert>

    <delete id="deleteFileList" parameterType="com.hy.spring.cloud.util.domain.Entity.Attachment">
        delete from file_attachment
        where id in (
            <foreach item="el" collection="attachmentList" separator=",">
                #{el.id}
            </foreach>
        )
    </delete>

    <select id="getAttachment" parameterType="java.lang.String" resultType="com.hy.spring.cloud.util.domain.Entity.Attachment">
          select
            id,
            fileName,
            pathUrl,
            fileType,
            status
          from file_attachment
          where id = #{fileId}
    </select>

    <select id="queryAttachmentList" parameterType="com.hy.spring.cloud.util.domain.Entity.Attachment" resultType="com.hy.spring.cloud.util.domain.Entity.Attachment">
        select
            id,
            fileName,
            pathUrl,
            fileType,
            status
        from file_attachment t
        <where>
            <if test="fileName != null and fileName != ''">
                <bind name="fileName" value="'%' + fileName + '%'"/>
                and t.fileName like #{fileName}
            </if>
            <if test="fileType != null and fileType != ''">
                or t.fileType = #{fileType}
            </if>
            <if test="status != null">
                or t.status = #{status}
            </if>
        </where>
    </select>

</mapper>